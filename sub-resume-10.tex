\expandafter\ifx\csname readornot\endcsname\relax
  \documentclass[uplatex]{jsarticle}
  \usepackage{octopus}
  \usepackage{url}
  \usetikzlibrary{calc}

  \renewcommand{\proofname}{\textsf{証明}}
  \renewcommand{\postpartname}{章}
  \renewcommand{\thesection}{\thepart.\arabic{section}}
  \renewcommand{\thepart}{\arabic{part}}
  \makeatletter\renewcommand{\theequation}{\thesection.\arabic{equation}}\@addtoreset{equation}{section}\makeatother

  \newcommand{\octopuspart}[1]{\newpage\part{#1}\setcounter{section}{0}\vspace{3\baselineskip}}

  \renewcommand{\restriction}[2]{\left. #1 \right|_{#2}}
  \DeclareMathOperator{\dcup}{\dot{\cup}}
  \DeclareMathOperator{\conv}{conv}
  \DeclareMathOperator{\Image}{Im}
  \DeclareMathOperator{\Kernel}{Ker}
  \DeclareMathOperator{\diag}{diag}
  \begin{document}
  \fi

\section{ホモロジーの計算 2}

\begin{teigi}[自由$\mathbb{Z}$加群]
  $G$が\nw{自由$\mathbb{Z}$加群}であるとは，$\mathbb{Z}$上の加群$G$が，
  $G \simeq \mathbb{Z}^{r}$であり，かつ$r$個の元$e_{1}, e_{2}, \dots, e_{r}$によって$g \in G$が一意に
  ${\displaystyle g = \sum_{i=1}^{r} n_{i} e_{i}}$とかけるものとする。
\end{teigi}

この$e_{1}, e_{2}, \dots, e_{r}$を$\mathbb{Z}$基底といい，$r$をランクと呼ぶ。

\begin{teigi}[ユニモジュラ行列]
  $Q$：$r$次正方整数行列とする。

  $Q$：\nw{ユニモジュラ（unimodular）} $\defines$ $\det Q = \pm 1$
\end{teigi}

ユニモジュラ行列の定義について次のことが成り立つ。
\renewcommand{\arraystretch}{1}
\begin{center}
  \begin{tabular}{lcl}
    $Q$：ユニモジュラ & $\defines$ & $\det Q = \pm 1$ \\
    & $\Longleftrightarrow$ & $e_{1}, e_{2}, \dots, e_{r}$が$\mathbb{Z}$基底ならば
    ${\displaystyle e_{i}' = \sum_{j=1}^{r} Q_{ij} e_{j}}$（$i = 1, \dots, r$）も$\mathbb{Z}$基底である 
  \end{tabular}
\end{center}

このことから，ユニモジュラ行列は，自由$\mathbb{Z}$加群の基底の変換行列であることが従う。
なお，$Q$は定義から正則行列であるが，逆行列$Q^{-1}$を余因子行列で書けば分かるように，$Q^{-1}$も整数行列であってユニモジュラ行列である。
したがって，${\displaystyle g = \sum_{i=1}^{n} n_{i} e_{i}}$ならば
\begin{equation}
  g = \sum_{j=1}^{r} \sum_{i=1}^{r} n_{i} (Q^{-1})_{ji} \, e_{j}'
\end{equation}
と新たな基底の下での表現を得ることができる。

\begin{teiri}[Smith標準形（単因子標準形）]
  （正方とは限らない）整数行列$A$は，あるユニモジュラ行列$P,Q$を用いて
  \begin{equation}
    \newcommand{\BigZero}{\kern3pt \hbox{\huge \strut 0}}
    PAQ = \left( \begin{array}{cccc|c}
      \alpha_{1} &            &        &            & \multirow{4}{*}{\BigZero} \\
                 & \alpha_{2} &        &            & \\
                 &            & \ddots &            & \\
                 &            &        & \alpha_{k} & \\ \hline
      \multicolumn{4}{c|}{\BigZero} & \BigZero
    \end{array} \right)
  \end{equation}
  の形にできる。ここで，$\alpha_{1} | \alpha_{2} | \dots | \alpha_{k}$（$\alpha_{i} > 0$）である。
  また，$\alpha_{1}, \dots, \alpha_{k}$は一意に定まり，これを$A$の\nw{単因子}と呼ぶ。
\end{teiri}

\begin{proof}
  以下に示すような基本変形を繰り返せば右辺のような形になる。：
  \begin{itemize}
    \vspace{-0.5\baselineskip}
    \item[(1)] $i$行（列）を$-1$倍する。
    \begin{equation}
      \begin{pmatrix}
        1 & \\
          & \ddots \\
          &        & -1 \\
          &        &    & \ddots \\ 
          &        &    &        & 1
      \end{pmatrix}
    \end{equation}
    \item[(2)] 行（列）の入れ替え
    \begin{equation}
      \left( \begin{array}{ccccccccccc}
        1 \\
          & \ddots \\
          &        & 1 \\
          &        &   & 0      & \hdots & \hdots & \hdots & 1      \\ 
          &        &   & \vdots & 1      &        &        & \vdots \\
          &        &   & \vdots &        & \ddots &        & \vdots \\
          &        &   & \vdots &        &        & 1      & \vdots \\
          &        &   & 1      & \hdots & \hdots & \hdots & 0      \\
          &        &   &        &        &        &        &        & 1 \\
          &        &   &        &        &        &        &        &   & \ddots \\
          &        &   &        &        &        &        &        &   &        & 1 
      \end{array} \right)
    \end{equation}
    \item[(3)] $i$行（列）を$c$倍して$j$行（列）に足す
    \begin{equation}
      \begin{pmatrix}
        1 & \\
          & \ddots \\
          &        & 1      \\
          &        & \vdots & \ddots \\
          &        & c      & \hdots & 1 \\ 
          &        &        &        &   & \ddots \\
          &        &        &        &   &        & 1
      \end{pmatrix}
    \end{equation}
  \end{itemize}
  これらの変形は直下に示したユニモジュラ行列による変換として表現できるので定理が従う。
\end{proof}

\begin{rei}
  実際にSmith標準形を求めてみる。
  \begin{center}
    $\begin{array}{ccc}
      \begin{pmatrix}
        -3 & 4 & 4 \\ -2 & 2 & -4 \\ 4 & -4 & 4
      \end{pmatrix} & \xrightarrow[\text{絶対値最小の非零要素を$(1,1)$成分へ}]{(1),(2)}
      & \begin{pmatrix}
        2 & -2 & 4 \\ -3 & 4 & 4 \\ 4 & -4 & 4
      \end{pmatrix} \\ & \xrightarrow[\text{1行，1列に$a_{11}$で割り切れないものがあればそれを「割った余り」にする}]{(3); 2 \text{行目} + 2 \times 1 \text{行目}}
      & \begin{pmatrix}
        2 & -2 & 4 \\ 1 & 0 & 12 \\ 4 & -4 & 4
      \end{pmatrix} \\ & \xrightarrow[\text{絶対値最小の非零要素を$(1,1)$成分へ}]{(1)}
      & \begin{pmatrix}
        1 & 0 & 12 \\ 2 & -2 & 4 \\ 4 & -4 & 4
      \end{pmatrix} \\ & \xrightarrow[\text{1行，1列がすべて$a_{11}$で割り切れる場合は割って0にする}]{(3)}
      & \begin{pmatrix}
        1 & 0 & 0 \\ 0 & -2 & -20 \\ 0 & -4 & -44
      \end{pmatrix} \\ & \xrightarrow[\text{右下の$2 \times 2$の小行列に対して同じアルゴリズムを適用}]{(1),(3)}
      & \begin{pmatrix}
        1 & 0 & 0 \\ 0 & 2 & -20 \\ 0 & 0 & -4
      \end{pmatrix} \\ & \xrightarrow{(1),(3)}
      & \begin{pmatrix}
        1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 4
      \end{pmatrix}
    \end{array}$
  \end{center}
  辿り着いた行列がSmith標準形である。
\end{rei}

すなわち，
\begin{itemize}
  \item 一番左の行と列に左上の要素で割り切れない要素があるときには，
  $a_{11}$で割った余りになるように変形した上でその要素を左上に移動する。
  \item 一番左の行と列に左上の要素で割り切れない要素がないときには，
  その行と列を1にするように変形し，サイズが一回り小さい行列に対して更に変形を続けていく。
\end{itemize}
の手順を踏むことでSmith標準形に辿り着く。

\begin{hodai}
  $BA = O$とし，$A$の単因子を$\alpha_{1} | \alpha_{2} | \dots | \alpha_{k}$，$B$の単因子を$\beta_{1} | \beta_{2} | \dots | \beta_{\ell}$とする。
  このとき，あるユニモジュラ行列$P,Q,R$が存在して，
  \begin{equation}
    R^{-1} B P = \begin{pmatrix}
      O_{k' \times k'} & O_{k' \times \ell} \\ O_{\ell \times k'} & \diag (\beta_{1}, \dots, \beta_{\ell})
    \end{pmatrix}, \quad
    P^{-1} A Q = \begin{pmatrix}
      \diag (\alpha_{1}, \dots, \alpha_{k}) & O \\ O & O
    \end{pmatrix}
  \end{equation}
  となる。ただし，$O_{m \times n}$で$m \times n$の大きさの零行列を表すとし，$k' \ge k$とする。
\end{hodai}

\begin{proof}
  まず，$A$をSmith標準形にする。$\tilde{P},Q$をユニモジュラ行列として，
  \begin{equation}
    \newcommand{\BigZero}{\kern3pt \hbox{\huge \strut 0}}
    \tilde{P}^{-1}AQ = \left( \begin{array}{cccc|c}
      \alpha_{1} &            &        &            & \multirow{4}{*}{\BigZero} \\
                 & \alpha_{2} &        &            & \\
                 &            & \ddots &            & \\
                 &            &        & \alpha_{k} & \\ \hline
      \multicolumn{4}{c|}{\BigZero} & \BigZero
    \end{array} \right)
  \end{equation}
  $BAQ = B\tilde{P} \tilde{P}^{-1} AQ = O$より，$B \tilde{P}$の形状は第1行から第$k$行までが零行列となっている。
  そこで，$B \tilde{P}$の第$k+1$行目以降の小行列に対して，Smith標準形をつくる。
  すると，$R,S$をユニモジュラ行列として次のようになる。
  \begin{equation}
    \newcommand{\BigZero}{\kern3pt \hbox{\huge \strut 0}}
    R B \tilde{P} \begin{pmatrix}
      I_{k} & O \\ O & S
    \end{pmatrix} = 
    \begin{array}{l}
      \hspace{1em}\overbrace{}^{k} \\
      \left( \begin{array}{c|c|c}
                &          & \multirow{4}{*}{\BigZero} \\
                &          &                           \\
                &          &                           \\
        \BigZero & \BigZero &                           \\ \cline{3-3}
                &          & \begin{array}{ccc} \beta_{1} & & \\ & \ddots & \\ & & \beta_{\ell} \end{array} \\
      \end{array} \right) \\
      \hspace{1em}\underbrace{\hspace{4em}}_{k'}
  \end{array}
  \end{equation}
  いま，
  \begin{equation*}
    P = \tilde{P} \begin{pmatrix}
      I_{k} & O \\ O & S
    \end{pmatrix}
  \end{equation*}
  とおけば，
  \begin{equation}
    \newcommand{\BigZero}{\kern3pt \hbox{\huge \strut 0}}
    P^{-1} A Q = \begin{pmatrix}
      I_{k} & O \\ O & S^{-1}
    \end{pmatrix}
    \tilde{P}^{-1} A Q =
    \left( \begin{array}{cccc|c}
      \alpha_{1} &            &        &            & \multirow{4}{*}{\BigZero} \\
                 & \alpha_{2} &        &            & \\
                 &            & \ddots &            & \\
                 &            &        & \alpha_{k} & \\ \hline
      \multicolumn{4}{c|}{\BigZero} & \BigZero
    \end{array} \right) 
  \end{equation}
  であり，
  \begin{equation}
    \newcommand{\BigZero}{\kern3pt \hbox{\huge \strut 0}}
    R^{-1} B P = \begin{array}{l}
      \hspace{1em}\overbrace{\hspace{4em}}^{k'} \\
      \left( \begin{array}{c|c|c}
                &          & \multirow{4}{*}{\BigZero} \\
                &          &                           \\
                &          &                           \\
        \BigZero & \BigZero &                           \\ \cline{3-3}
                &          & \begin{array}{ccc} \beta_{1} & & \\ & \ddots & \\ & & \beta_{\ell} \end{array} \\
      \end{array} \right)
    \end{array}
  \end{equation}
  である。
\end{proof}

\sukima \midashi{\large ホモロジーの計算}

$X$：位相空間，$\Delta$-複体構造，$c_{n}$：$n$-単体の個数（有限とする），とする。
このとき，
\begin{center}
  \begin{tabular}{l@{\,}c@{\,}l}
    $\Delta_{n}$ & $:=$ & $n$-チェイン全体（$n$-単体の整数結合） \\
    & $\sim$ & ランク$c_{n}$の自由$\mathbb{Z}$加群，特に$n$-単体$\sigma_{1},\sigma_{2}, \dots, \sigma_{c_{n}}$は$\Delta_{n}$の$\mathbb{Z}$基底 \\
    & $\simeq$ & $\mathbb{Z}^{c_{n}}$
  \end{tabular}
\end{center}
である。よって，境界作用素$\partial_{n} \colon \Delta_{n} \longrightarrow \Delta_{n-1}$は$\mathbb{Z}^{c_{n}} \longrightarrow \mathbb{Z}^{c_{n-1}}$と見なすことができ，
これを行列によって表示できる。
\begin{align}
  & \partial_{n} \colon \mapdef{\Delta_{n}}{\Delta_{n-1}}{\displaystyle \sum_{i=1}^{c_{n}} t_{i} \sigma_{i}}{\displaystyle \sum_{i=1}^{c_{n}} t_{i} \partial \sigma_{i}} \\
  & \partial_{n}^{*} \colon \mapdef{\mathbb{Z}^{c_{n}}}{\mathbb{Z}^{c_{n-1}}}{
    \begin{pmatrix}
      \sigma_{1} & \sigma_{2} & \cdots & \sigma_{c_{n}}
    \end{pmatrix}
    \begin{pmatrix}
      t_{1} \\ t_{2} \\ \vdots \\ t_{c_{n}}
    \end{pmatrix}
  }{
    \begin{pmatrix}
      \pi_{1} & \pi_{2} & \cdots & \pi_{c_{n-1}}
    \end{pmatrix} A
    \begin{pmatrix}
      t_{1} \\ t_{2} \\ \vdots \\ t_{c_{n}}
    \end{pmatrix}
  }
\end{align}
ここで，$c_{n-1} \times c_{n}$次行列$A$は$\partial_{n}$の行列表示であり，
$\partial \sigma_{j}$における$\pi_{i}$の係数を$(i,j)$成分にもつものとする。

\begin{rei}[射影平面の場合]
  $X = P^{2}$：2次元射影空間（射影平面）とする。
  \begin{center}
		\begin{tikzpicture}
			\fill[red!20] (0,0) -- (2,2) -- (0,2) -- cycle;
			\fill[blue!20] (0,0) -- (2,2) -- (2,0) -- cycle;
			\fill \point{(0,0)}{below left}{$u$} \point{(2,0)}{below right}{$v$} \point{(0,2)}{above left}{$v$} \point{(2,2)}{above right}{$u$};
			\node at (1,0) [below]{$b$} node at (0,1) [left]{$a$} node at (1,2) [above]{$b$} node at (2,1) [right]{$a$} node at (1,1) [left]{$c$};
			\node at (0.5,1.5){$U$} node at (1.5,0.5){$L$};
			\midwayarrow{(0,0)}{(2,0)} \midwayarrow{(0,0)}{(0,2)} \midwayarrow{(0,0)}{(2,2)} \midwayarrow{(2,2)}{(2,0)} \midwayarrow{(2,2)}{(0,2)}
		\end{tikzpicture}
  \end{center}
  \begin{itemize}
    \item $\Delta_{2} \simeq \sets{\begin{pmatrix}
      t_{U} & t_{L} 
    \end{pmatrix}^{\top} | t_{U}, t_{L} \in \mathbb{Z}} = \mathbb{Z}^{2}$
    \item $\Delta_{1} \simeq \sets{\begin{pmatrix}
      t_{a} & t_{b} & t_{c} 
    \end{pmatrix}^{\top} | t_{a}, t_{b}, t_{c} \in \mathbb{Z}} = \mathbb{Z}^{3}$
    \item $\Delta_{0} \simeq \sets{\begin{pmatrix}
      t_{u} & t_{v} 
    \end{pmatrix}^{\top} | t_{u}, t_{v} \in \mathbb{Z}} = \mathbb{Z}^{2}$
  \end{itemize}
  このとき，境界作用素の行列表示はそれぞれ，
  \begin{equation}
    A_{\partial_{1}} = \begin{array}{c@{\,}c}
      & \begin{array}{ccc}
        a & b & c
      \end{array} \\
      \begin{array}{c}
        u \\ v
      \end{array} & 
      \begin{pmatrix}
        -1 & 1 & 0 \\
        -1 & 1 & 0
      \end{pmatrix}  
    \end{array}
    , \quad 
    A_{\partial_{2}} = \begin{array}{c@{\,}c}
      & \begin{array}{cc}
        U & L
      \end{array} \\
      \begin{array}{c}
        a \\ b \\ c
      \end{array} &
      \begin{pmatrix}
      -1 & 1 \\
      1 & -1 \\
      1 & 1
    \end{pmatrix}
  \end{array}
  \end{equation}
\end{rei}

\expandafter\ifx\csname readornot\endcsname\relax
  \end{document}
\fi